rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Cafe24 토큰 컬렉션 규칙
    match /cafe24_tokens/{userId} {
      // 로컬 사용자는 자신의 토큰만 읽기/쓰기 가능
      allow read: if userId == 'local_user';
      allow write: if userId == 'local_user';

      // 인증된 사용자는 자신의 토큰만 읽기/쓰기 가능
      allow read: if request.auth != null && request.auth.uid == userId;
      allow write: if request.auth != null && request.auth.uid == userId;
    }

    // 배경 카테고리 (공개 읽기, CMS 쓰기)
    match /background_categories/{categoryId} {
      allow read: if true;  // 에디터에서 읽기 가능
      allow write: if true; // CMS에서 쓰기 가능 (나중에 인증 추가 가능)
    }

    // 배경 이미지 (공개 읽기, CMS 쓰기)
    match /backgrounds/{backgroundId} {
      allow read: if true;  // 에디터에서 읽기 가능
      allow write: if true; // CMS에서 쓰기 가능 (나중에 인증 추가 가능)
    }

    // 제품 메타데이터 (공개 읽기, CMS 쓰기)
    match /product_metadata/{productId} {
      allow read: if true;  // 에디터에서 읽기 가능
      allow write: if true; // CMS에서 쓰기 가능 (나중에 인증 추가 가능)
    }

    // 기타 모든 문서는 거부
    match /{document=**} {
      allow read, write: if false;
    }
  }
}